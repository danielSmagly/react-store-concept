{"ast":null,"code":"import _regeneratorRuntime from\"/Users/danielsmagly/Desktop/ReactStoreConcept/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/danielsmagly/Desktop/ReactStoreConcept/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/danielsmagly/Desktop/ReactStoreConcept/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{CssBaseline,Paper,Stepper,Step,StepLabel,Typography,CircularProgress,Divider,Button}from'@material-ui/core';import{Link,useHistory}from'react-router-dom';import{commerce}from'../../../lib/commerce';import AddressForm from'../AddressForm';import PaymentForm from'../PaymentForm';import useStyles from'./styles';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var steps=['Shipping address','Payment details'];var Checkout=function Checkout(_ref){var cart=_ref.cart,onCaptureCheckout=_ref.onCaptureCheckout,order=_ref.order,error=_ref.error;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),checkoutToken=_useState2[0],setCheckoutToken=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),activeStep=_useState4[0],setActiveStep=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),shippingData=_useState6[0],setShippingData=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isFinished=_useState8[0],setIsFinished=_useState8[1];var classes=useStyles();var history=useHistory();var backStep=function backStep(){return setActiveStep(function(prevActiveStep){return prevActiveStep-1;});};var nextStep=function nextStep(){return setActiveStep(function(prevActiveStep){return prevActiveStep+1;});};useEffect(function(){if(cart.id){var generateToken=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var token;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return commerce.checkout.generateToken(cart.id,{type:'cart'});case 3:token=_context.sent;setCheckoutToken(token);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);history.push('/');case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function generateToken(){return _ref2.apply(this,arguments);};}();generateToken();}},[cart]);var test=function test(data){setShippingData(data);nextStep();};var timeout=function timeout(){setTimeout(function(){setIsFinished(true);},10000);};var Confirmation=function Confirmation(){return order.customer?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h5\",children:[\"Thank you for your purchase, \",order.customer.firstname,\" \",order.customer.lastname,\"!\"]}),/*#__PURE__*/_jsx(Divider,{className:classes.divider}),/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle2\",children:[\"Order ref: \",order.customer_reference]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Button,{component:Link,variant:\"outlined\",type:\"button\",to:\"/\",children:\"Back to home\"})]}):isFinished?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",children:\"Thank you for your purchase!\"}),/*#__PURE__*/_jsx(Divider,{className:classes.divider})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Button,{component:Link,variant:\"outlined\",type:\"button\",to:\"/\",children:\"Back to home\"})]}):/*#__PURE__*/_jsx(\"div\",{className:classes.spinner,children:/*#__PURE__*/_jsx(CircularProgress,{})});};if(error){Confirmation=function Confirmation(){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h5\",children:[\"Error: \",error]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Button,{component:Link,variant:\"outlined\",type:\"button\",to:\"/\",children:\"Back to home\"})]});};}var Form=function Form(){return activeStep===0?/*#__PURE__*/_jsx(AddressForm,{checkoutToken:checkoutToken,nextStep:nextStep,setShippingData:setShippingData,test:test}):/*#__PURE__*/_jsx(PaymentForm,{checkoutToken:checkoutToken,nextStep:nextStep,backStep:backStep,shippingData:shippingData,onCaptureCheckout:onCaptureCheckout,timeout:timeout});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CssBaseline,{}),/*#__PURE__*/_jsx(\"div\",{className:classes.toolbar}),/*#__PURE__*/_jsx(\"main\",{className:classes.layout,children:/*#__PURE__*/_jsxs(Paper,{className:classes.paper,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",align:\"center\",children:\"Checkout\"}),/*#__PURE__*/_jsx(Stepper,{activeStep:activeStep,className:classes.stepper,children:steps.map(function(label){return/*#__PURE__*/_jsx(Step,{children:/*#__PURE__*/_jsx(StepLabel,{children:label})},label);})}),activeStep===steps.length?/*#__PURE__*/_jsx(Confirmation,{}):checkoutToken&&/*#__PURE__*/_jsx(Form,{})]})})]});};export default Checkout;","map":{"version":3,"sources":["/Users/danielsmagly/Desktop/ReactStoreConcept/src/components/CheckoutForm/Checkout/Checkout.jsx"],"names":["React","useState","useEffect","CssBaseline","Paper","Stepper","Step","StepLabel","Typography","CircularProgress","Divider","Button","Link","useHistory","commerce","AddressForm","PaymentForm","useStyles","steps","Checkout","cart","onCaptureCheckout","order","error","checkoutToken","setCheckoutToken","activeStep","setActiveStep","shippingData","setShippingData","isFinished","setIsFinished","classes","history","backStep","prevActiveStep","nextStep","id","generateToken","checkout","type","token","push","test","data","timeout","setTimeout","Confirmation","customer","firstname","lastname","divider","customer_reference","spinner","Form","toolbar","layout","paper","stepper","map","label","length"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { CssBaseline, Paper, Stepper, Step, StepLabel, Typography, CircularProgress, Divider, Button } from '@material-ui/core';\nimport { Link, useHistory } from 'react-router-dom';\n\nimport { commerce } from '../../../lib/commerce';\nimport AddressForm from '../AddressForm';\nimport PaymentForm from '../PaymentForm';\nimport useStyles from './styles';\n\nconst steps = ['Shipping address', 'Payment details'];\n\nconst Checkout = ({ cart, onCaptureCheckout, order, error }) => {\n  const [checkoutToken, setCheckoutToken] = useState(null);\n  const [activeStep, setActiveStep] = useState(0);\n  const [shippingData, setShippingData] = useState({});\n  const [isFinished, setIsFinished] = useState(false);\n  const classes = useStyles();\n  const history = useHistory();\n\n\n  const backStep = () => setActiveStep((prevActiveStep) => prevActiveStep - 1);\n\n  const nextStep = () => setActiveStep((prevActiveStep) => prevActiveStep + 1);\n  useEffect(() => {\n    if (cart.id) {\n      const generateToken = async () => {\n        try {\n          const token = await commerce.checkout.generateToken(cart.id, { type: 'cart' });\n\n          setCheckoutToken(token);\n        } catch {\n          history.push('/');\n        }\n      };\n\n      generateToken();\n    }\n  }, [cart]);\n\n  const test = (data) => {\n    setShippingData(data);\n\n    nextStep();\n  };\n\n  const timeout = () => {\n    setTimeout(() => {\n      setIsFinished(true);\n    }, 10000);\n  }\n\n  let Confirmation = () => order.customer ? (\n    <>\n      <div>\n        <Typography variant=\"h5\">Thank you for your purchase, {order.customer.firstname} {order.customer.lastname}!</Typography>\n        <Divider className={classes.divider} />\n        <Typography variant=\"subtitle2\">Order ref: {order.customer_reference}</Typography>\n      </div>\n      <br />\n      <Button component={Link} variant=\"outlined\" type=\"button\" to=\"/\">Back to home</Button>\n    </>\n  ) : isFinished ? (\n    <>\n      <div>\n        <Typography variant=\"h5\">Thank you for your purchase!</Typography>\n        <Divider className={classes.divider} />\n        \n      </div>\n      <br />\n      <Button component={Link} variant=\"outlined\" type=\"button\" to=\"/\">Back to home</Button>\n    </>\n  ) : (\n    <div className={classes.spinner}>\n      <CircularProgress />\n    </div>\n  );\n\n  if (error) {\n    Confirmation = () => (\n      <>\n        <Typography variant=\"h5\">Error: {error}</Typography>\n        <br />\n        <Button component={Link} variant=\"outlined\" type=\"button\" to=\"/\">Back to home</Button>\n      </>\n    );\n  }\n\n  const Form = () => (activeStep === 0\n    ? <AddressForm checkoutToken={checkoutToken} nextStep={nextStep} setShippingData={setShippingData} test={test} />\n    : <PaymentForm checkoutToken={checkoutToken} \n        nextStep={nextStep} \n        backStep={backStep} \n        shippingData={shippingData} \n        onCaptureCheckout={onCaptureCheckout} \n        timeout={timeout}/>);\n\n  return (\n    <>\n      <CssBaseline />\n      <div className={classes.toolbar} />\n      <main className={classes.layout}>\n        <Paper className={classes.paper}>\n          <Typography variant=\"h4\" align=\"center\">Checkout</Typography>\n          <Stepper activeStep={activeStep} className={classes.stepper}>\n            {steps.map((label) => (\n              <Step key={label}>\n                <StepLabel>{label}</StepLabel>\n              </Step>\n            ))}\n          </Stepper>\n          {activeStep === steps.length ? <Confirmation /> : checkoutToken && <Form />}\n        </Paper>\n      </main>\n    </>\n  );\n};\n\nexport default Checkout;"]},"metadata":{},"sourceType":"module"}